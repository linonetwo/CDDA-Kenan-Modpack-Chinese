[
  {
    "id": "dash_basic",
    "type": "SPELL",
    "name": { "str": "Dash" },
    "description": "Move quickly towards a nearby position.",
    "spell_class": "NONE",
    "teachable": false,
    "valid_targets": [ "ground", "hostile" ],
    "effect": "dash",
    "extra_effects": [ { "id": "dash_basic_levitate" } ],
    "shape": "line",
    "min_range": 4,
    "max_range": 4,
    "max_level": 1,
    "difficulty": -20,
    "base_casting_time": 80,
    "base_energy_cost": 2333,
    "energy_source": "STAMINA",
    "flags": [ "EXTRA_EFFECTS_FIRST", "NO_HANDS", "NO_LEGS", "SILENT" ],
    "//": "Stamina severely limits the usage of this spell. Another new resource should be used instead to emulate an average of 3 charges that quickly recovers over time during battle. This would allow the use of wind up and telegraph mechanics for enemies and make combat more dynamic. Different characters have different variations of the dash: Remi should have a shorter spammeable dash that automatically does damage if targeted to an enemy, while Utsuho's should be longer and spawn perpendicular danmaku so she keeps her distance. Because of the current stamina limitations, I assume a pool of 7000 stamina can be used for dashes in a given combat situation"
  },
  {
    "id": "dash_basic_levitate",
    "type": "SPELL",
    "name": { "str": "Dash (levitation)" },
    "description": "Grants temporary LEVITATION for dashes",
    "spell_class": "NONE",
    "valid_targets": [ "self" ],
    "effect": "attack",
    "effect_str": "dash_levitation",
    "shape": "blast",
    "min_aoe": 20,
    "max_aoe": 20,
    "max_level": 1,
    "difficulty": -20,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "STAMINA",
    "flags": [ "NO_EXPLOSION_SFX", "NO_HANDS", "NO_LEGS", "SILENT" ],
    "//": "Solution adapted from Aftershock mod's spell_rocket_jump to address #53532",
    "//2": "Note: range is set at 20 else dash_levitation fails to trigger sometimes. Dunno why this is"
  },
  {
    "id": "dash_aya",
    "type": "SPELL",
    "name": { "str": "Dash dominance" },
    "description": "Move quickly towards a nearby position.",
    "spell_class": "NONE",
    "teachable": false,
    "valid_targets": [ "ground", "hostile" ],
    "effect": "dash",
    "extra_effects": [ { "id": "dash_basic_levitate" } ],
    "shape": "line",
    "min_range": 6,
    "max_range": 6,
    "max_level": 1,
    "difficulty": -20,
    "base_casting_time": 15,
    "base_energy_cost": 2111,
    "energy_source": "STAMINA",
    "flags": [ "EXTRA_EFFECTS_FIRST", "NO_HANDS", "NO_LEGS" ]
  },
  {
    "id": "dash_kokoro",
    "type": "SPELL",
    "name": { "str": "Roaring fox mask" },
    "description": "Temporarely equip your Roaring Fox mask to quickly jump towards an enemy, dealing damage after landing.",
    "spell_class": "NONE",
    "teachable": false,
    "valid_targets": [ "self" ],
    "effect": "effect_on_condition",
    "effect_str": "dash_kokoro_eoc",
    "extra_effects": [ { "id": "dash_basic_levitate" } ],
    "shape": "blast",
    "max_level": 1,
    "difficulty": -20,
    "base_casting_time": 95,
    "base_energy_cost": 2333,
    "energy_source": "STAMINA",
    "flags": [ "EXTRA_EFFECTS_FIRST", "NO_EXPLOSION_SFX", "NO_HANDS", "NO_PROJECTILE", "SILENT" ],
    "//": "This dash has to be set up by using 'spell_EOC (+ dash_basic_levitate) -> EOC -> dash, spell2', instead of the usual 'dash (+ dash_basic_levitate + spell_EOC) -> EOC -> spell2', as dashes are bugged (#53532) so they require the dash_basic_levitate to work over z-levels, but by chaining dash_basic_levitate + spell_EOC with the EXTRA_EFFECTS_FIRST, spell2 is casted before dash; the alternative is removing the EXTRA_EFFECTS_FIRST flag which causes her to suffer fall damage as dash_basic_levitate is casted after she moves to the end of dash",
    "//2": "The price of doing it this way is that if Kokoro cancels her dash she still spends stamina. Which is better than the alternative"
  },
  {
    "id": "dash_kokoro2",
    "type": "SPELL",
    "name": { "str": "Roaring fox mask (dash)" },
    "description": "Actual dash for dash_kokoro ",
    "spell_class": "NONE",
    "valid_targets": [ "ally", "ground", "hostile" ],
    "effect": "dash",
    "shape": "line",
    "damage_type": "bash",
    "min_damage": { "math": [ "( (u_skill('melee') * 0.8 ) + (u_skill('dodge') * 0.8 ) + 9.6 )" ] },
    "max_damage": 32,
    "min_range": 4,
    "max_range": 4,
    "max_level": 1,
    "difficulty": -20,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "STAMINA",
    "flags": [ "NO_HANDS", "NO_LEGS" ],
    "//": "min dmg 16"
  },
  {
    "id": "dash_kokoro3",
    "type": "SPELL",
    "name": { "str": "Roaring fox mask (land dmg)" },
    "description": "Land dmg for dash_kokoro ",
    "spell_class": "NONE",
    "valid_targets": [ "ally", "ground", "hostile" ],
    "effect": "attack",
    "shape": "blast",
    "damage_type": "soul",
    "min_damage": { "math": [ "( (u_skill('melee') * 0.8 ) + (u_skill('dodge') * 0.8 ) + 9.6 )" ] },
    "max_damage": 32,
    "min_range": 20,
    "max_range": 20,
    "min_aoe": 1,
    "max_aoe": 1,
    "max_level": 1,
    "difficulty": -20,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "STAMINA",
    "flags": [ "NO_HANDS", "NO_LEGS" ],
    "//": "Note: range is set at 20 else dash_kokoro_eoc fails to trigger sometimes. Dunno why, it's the same thing with dash_levitation ",
    "//2": "min dmg 16"
  },
  {
    "id": "dash_meiling",
    "type": "SPELL",
    "name": { "str": "Rising Dragon kick" },
    "description": "Fill your legs with qi, kicking into an enemy from a distance.",
    "spell_class": "NONE",
    "teachable": false,
    "valid_targets": [ "ground", "hostile" ],
    "effect": "dash",
    "extra_effects": [ { "id": "dash_basic_levitate" } ],
    "shape": "line",
    "damage_type": "bash",
    "min_damage": { "math": [ "( (u_skill('swimming') * 1.34 ) + (u_skill('melee') * 1.34 ) + (u_skill('unarmed') * 1.34 ) + 13.4 )" ] },
    "max_damage": 64,
    "min_range": 5,
    "max_range": 5,
    "max_level": 1,
    "difficulty": -20,
    "base_casting_time": 100,
    "base_energy_cost": 2333,
    "energy_source": "STAMINA",
    "flags": [ "EXTRA_EFFECTS_FIRST", "NO_PROJECTILE" ],
    "//": "This should move her + the target along the way. Do not make MA technique version as this is her custom dash",
    "//2": "min dmg 24"
  },
  {
    "id": "dash_mokou",
    "type": "SPELL",
    "name": { "str": "Fire burst" },
    "description": "Cause an explosion beneath your feet to launch yourself forward.",
    "spell_class": "NONE",
    "teachable": false,
    "valid_targets": [ "ground", "hostile" ],
    "effect": "attack",
    "extra_effects": [ { "id": "dash_mokou2" } ],
    "shape": "blast",
    "damage_type": "heat",
    "min_damage": { "math": [ "( (u_skill('melee') * 1.4 ) + (u_skill('unarmed') * 1.4 ) + (u_pain() * 0.2 ) + 8.8 )" ] },
    "max_damage": 64,
    "min_aoe": 1,
    "max_aoe": 1,
    "max_level": 1,
    "difficulty": -20,
    "base_casting_time": 80,
    "base_energy_cost": 2000,
    "energy_source": "STAMINA",
    "flags": [ "IGNITE_FLAMMABLE", "LOUD", "NO_HANDS" ],
    "//": "min dmg 20. The formula caps at 48 with maxed skills, the gap is reached with the pain modifier"
  },
  {
    "id": "dash_mokou2",
    "type": "SPELL",
    "name": { "str": "Fire burst (EOC)" },
    "description": "Subspell for dash_mokou, this queues the actual dash via EOC",
    "spell_class": "NONE",
    "valid_targets": [ "self" ],
    "effect": "effect_on_condition",
    "effect_str": "dash_mokou_eoc",
    "shape": "blast",
    "max_level": 1,
    "difficulty": -20,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "MANA",
    "flags": [ "NO_EXPLOSION_SFX", "NO_HANDS", "NO_LEGS", "NO_PROJECTILE", "SILENT" ]
  },
  {
    "id": "dash_mokou3",
    "type": "SPELL",
    "name": { "str": "Fire burst (dash)" },
    "description": "Dash for dash_mokou ",
    "spell_class": "NONE",
    "valid_targets": [ "ground", "hostile" ],
    "effect": "dash",
    "extra_effects": [ { "id": "dash_basic_levitate" } ],
    "shape": "line",
    "damage_type": "bash",
    "min_damage": { "math": [ "( (u_skill('melee') * 0.4 ) + (u_skill('unarmed') * 0.4 ) + (u_pain() * 0.11 ) + 4.8 )" ] },
    "max_damage": 24,
    "min_range": 5,
    "max_range": 5,
    "max_level": 1,
    "difficulty": -20,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "STAMINA",
    "flags": [ "EXTRA_EFFECTS_FIRST", "NO_EXPLOSION_SFX", "NO_HANDS", "SILENT" ],
    "//": "min dmg 8. The formula caps at 16 with maxed skills, the gap is reached with the pain modifier"
  },
  {
    "id": "dash_reisen",
    "type": "SPELL",
    "name": { "str": "[Unknown ability]" },
    "description": "Use your [Unknown ability] to blink between positions.  Or vanish and reappear? For you, it's just natural.",
    "spell_class": "NONE",
    "teachable": false,
    "valid_targets": [ "ground" ],
    "effect": "short_range_teleport",
    "shape": "line",
    "min_range": 5,
    "max_range": 5,
    "max_level": 1,
    "difficulty": -20,
    "base_casting_time": 33,
    "base_energy_cost": 1888,
    "energy_source": "STAMINA",
    "flags": [ "NO_HANDS", "NO_LEGS", "SILENT", "TARGET_TELEPORT" ]
  },
  {
    "id": "dash_remi",
    "type": "SPELL",
    "name": { "str": "Heartbreaker" },
    "description": "Dash towards your opponents, striking them with your claws.",
    "spell_class": "NONE",
    "teachable": false,
    "valid_targets": [ "ground", "hostile" ],
    "effect": "dash",
    "extra_effects": [ { "id": "dash_basic_levitate" } ],
    "shape": "line",
    "damage_type": "cut",
    "min_damage": { "math": [ "( (u_skill('stabbing') * 0.54 ) + (u_skill('melee') * 0.53 ) + (u_skill('dodge') * 0.53 ) + 9.6 )" ] },
    "max_damage": 32,
    "min_pierce": { "math": [ "( (u_skill('stabbing') * 0.2 ) + (u_skill('melee') * 0.2 ) + (u_skill('dodge') * 0.2 ) - 0.4 )" ] },
    "max_pierce": 8,
    "min_range": 3,
    "max_range": 3,
    "max_level": 1,
    "difficulty": -20,
    "base_casting_time": 66,
    "base_energy_cost": 1888,
    "energy_source": "STAMINA",
    "flags": [ "EXTRA_EFFECTS_FIRST", "NO_HANDS", "NO_LEGS", "SILENT" ],
    "//": "Sadly the HEART can't be prioritized. YET",
    "//2": "min dmg 16, min pierce 2"
  },
  {
    "id": "dash_remi2",
    "type": "SPELL",
    "name": { "str": "Heartbreaker (dmg)" },
    "description": "aoe dmg component for dash_remi ",
    "spell_class": "NONE",
    "valid_targets": [ "hostile" ],
    "effect": "attack",
    "shape": "blast",
    "damage_type": "cut",
    "min_damage": { "math": [ "( (u_skill('stabbing') * 0.54 ) + (u_skill('melee') * 0.53 ) + (u_skill('dodge') * 0.53 ) + 9.6 )" ] },
    "max_damage": 32,
    "min_pierce": { "math": [ "( (u_skill('stabbing') * 0.34 ) + (u_skill('melee') * 0.33 ) + (u_skill('dodge') * 0.33 ) - 2 )" ] },
    "max_pierce": 12,
    "min_aoe": 1,
    "max_aoe": 1,
    "difficulty": -20,
    "max_level": 1,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "STAMINA",
    "flags": [ "NO_HANDS", "NO_LEGS" ],
    "//": "min dmg 16, min pierce 2"
  },
  {
    "id": "dash_sakuya",
    "type": "SPELL",
    "name": { "str": "Dash (elegant)" },
    "description": "Move elegant and quickly towards a nearby position.",
    "spell_class": "NONE",
    "teachable": false,
    "valid_targets": [ "ground", "hostile" ],
    "effect": "dash",
    "extra_effects": [ { "id": "dash_basic_levitate" } ],
    "shape": "line",
    "min_range": 4,
    "max_range": 4,
    "max_level": 1,
    "difficulty": -20,
    "base_casting_time": 80,
    "base_energy_cost": 2333,
    "energy_source": "STAMINA",
    "flags": [ "EXTRA_EFFECTS_FIRST", "NO_HANDS", "NO_LEGS", "SILENT" ]
  },
  {
    "id": "dash_utsuho",
    "type": "SPELL",
    "name": { "str": "Fission dive" },
    "description": "Dash towards a point, causing damage to the target.  You're invulnerable during the dash.",
    "spell_class": "NONE",
    "teachable": false,
    "valid_targets": [ "ground", "hostile" ],
    "effect": "dash",
    "extra_effects": [ { "id": "dash_utsuho2" }, { "id": "dash_basic_levitate" } ],
    "shape": "line",
    "damage_type": "bash",
    "min_damage": { "math": [ "( (u_skill('dodge') * 4.8 ) + 6.4 )" ] },
    "max_damage": 64,
    "min_range": 10,
    "max_range": 10,
    "difficulty": -20,
    "max_level": 1,
    "base_casting_time": 150,
    "base_energy_cost": 2500,
    "energy_source": "STAMINA",
    "flags": [ "EXTRA_EFFECTS_FIRST", "NO_HANDS", "NO_LEGS" ],
    "//": "Ideally, this dash should have a fixed minimum travel distance of 6 and a fixed maximum of 10",
    "//2": "How long is the travel time for dashes?"
  },
  {
    "id": "dash_utsuho2",
    "type": "SPELL",
    "name": { "str": "Fission dive (invulnerability)" },
    "description": "Invulnerability component for dash_utsuho ",
    "spell_class": "NONE",
    "valid_targets": [ "self" ],
    "effect": "attack",
    "effect_str": "debug_full_protection",
    "shape": "blast",
    "min_range": 1,
    "max_range": 1,
    "min_duration": 150,
    "max_duration": 150,
    "max_level": 1,
    "difficulty": -20,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "STAMINA",
    "flags": [ "NO_HANDS", "NO_LEGS" ]
  },
  {
    "id": "dash_utsuho3",
    "type": "SPELL",
    "name": { "str": "Fission dive (dmg)" },
    "description": "Damage component for dash_utsuho ",
    "spell_class": "NONE",
    "valid_targets": [ "ground", "hostile" ],
    "effect": "attack",
    "shape": "line",
    "damage_type": "bash",
    "min_damage": { "math": [ "( (u_skill('dodge') * 4.8 ) + 6.4 )" ] },
    "max_damage": 64,
    "min_range": 10,
    "max_range": 10,
    "max_level": 1,
    "difficulty": -20,
    "base_casting_time": 0,
    "base_energy_cost": 0,
    "energy_source": "STAMINA",
    "flags": [ "NO_HANDS", "NO_LEGS" ]
  },
  {
    "id": "dash_youmu",
    "type": "SPELL",
    "name": { "str": "Sakura slash" },
    "description": "Move quickly towards a nearby position.  You can dash through targets, slashing them in the process (requires swords).",
    "spell_class": "NONE",
    "teachable": false,
    "valid_targets": [ "self" ],
    "effect": "effect_on_condition",
    "effect_str": "dash_youmu_eoc",
    "shape": "blast",
    "max_level": 1,
    "difficulty": -11,
    "base_casting_time": 50,
    "base_energy_cost": 2333,
    "energy_source": "STAMINA",
    "flags": [ "NO_EXPLOSION_SFX", "NO_HANDS", "NO_LEGS", "SOMATIC" ],
    "//": "A second dash could be: Youmu activates it and puts down an aoe field. When the first enemy crosses it, she slashes past it 1 - 2 tiles while dealing heavy cut/soul damage. It should last 4 - 6 seconds at most, be automatic and if it fails (due no enemy, cc or whatever) it refunds half the cost. Also 1 - 2 turns after the damage cherry blossom petals should explode from the target."
  },
  {
    "id": "dash_youmu2",
    "type": "SPELL",
    "name": { "str": "Sakura slash" },
    "description": "Dash to a position with great force.  You can dash through targets, slashing them in the process.",
    "spell_class": "NONE",
    "valid_targets": [ "ally", "ground", "hostile" ],
    "effect": "attack",
    "extra_effects": [ { "id": "dash_basic_levitate" } ],
    "shape": "line",
    "damage_type": "cut",
    "min_damage": { "math": [ "( (u_skill('cutting') * 4 ) + (u_skill('dodge') * 4 ) + 8 )" ] },
    "max_damage": 112,
    "min_range": 4,
    "max_range": 4,
    "max_level": 1,
    "difficulty": -20,
    "base_casting_time": 50,
    "base_energy_cost": 2333,
    "energy_source": "STAMINA",
    "flags": [ "EXTRA_EFFECTS_FIRST", "NO_HANDS", "NO_LEGS", "NO_PROJECTILE" ],
    "//": "min dmg 44",
    "//2": "This should do half soul half cut dmg. Also, cherry blossom petals should linger around after I figure how to use field effects..."
  },
  {
    "id": "dash_youmu3",
    "type": "SPELL",
    "name": { "str": "Sakura slash" },
    "description": "Move quickly towards a nearby position.",
    "spell_class": "NONE",
    "valid_targets": [ "ground", "hostile" ],
    "effect": "dash",
    "extra_effects": [ { "id": "dash_basic_levitate" } ],
    "shape": "line",
    "min_range": 4,
    "max_range": 4,
    "max_level": 1,
    "difficulty": -20,
    "base_casting_time": 50,
    "base_energy_cost": 2333,
    "energy_source": "STAMINA",
    "flags": [ "EXTRA_EFFECTS_FIRST", "NO_HANDS", "NO_LEGS" ]
  },
  {
    "id": "fly_downwards",
    "type": "SPELL",
    "name": "[↓] Fly downwards",
    "description": "Fly downwards.",
    "spell_class": "NONE",
    "teachable": false,
    "valid_targets": [ "self" ],
    "effect": "effect_on_condition",
    "effect_str": "fly_downwards_eoc",
    "shape": "blast",
    "difficulty": -50,
    "message": "",
    "base_casting_time": 85,
    "flags": [ "NO_FAIL", "NO_HANDS", "NO_LEGS", "NON_MAGICAL", "SILENT" ],
    "//": "Adapted from #74988",
    "//2": "This and fly_upwards work perfectly good. Not deleting them yet to keep the syntax somewhere"
  },
  {
    "id": "fly_upwards",
    "type": "SPELL",
    "name": "[↑] Fly upwards",
    "description": "Fly upwards.",
    "spell_class": "NONE",
    "teachable": false,
    "valid_targets": [ "self" ],
    "effect": "effect_on_condition",
    "effect_str": "fly_upwards_eoc",
    "shape": "blast",
    "difficulty": -50,
    "message": "",
    "base_casting_time": 85,
    "flags": [ "NO_FAIL", "NO_HANDS", "NO_LEGS", "NON_MAGICAL", "SILENT" ]
  }
]
